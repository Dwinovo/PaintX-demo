<!DOCTYPE html>
<html>
<head>
    <title>This is PaintX</title>
    <style>
        #modal {
            display: none;
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <form id="uploadForm">
        <div align="center" style="position:relative;top:250px;left: 90px;"><input type="file" id="imageInput" accept="image/*"></div>
        <div align="center" style="position:relative;top:300px;"><button type="submit">上传图片</button></div>
    </form>

    <!-- 模态框 -->
    <div id="modal">请等待，正在上传...</div>

    <script>
        document.getElementById('uploadForm').addEventListener('submit', function(event) {
            event.preventDefault(); // 阻止表单默认提交
            const file = document.getElementById('imageInput').files[0];
            const modal = document.getElementById('modal');

            if (file) {
                // 显示模态框而不是使用alert
                modal.style.display = 'flex';

                const reader = new FileReader();
                reader.onloadend = function() {
                    const base64Image = reader.result.split(',')[1];
                    
                    fetch('https://enk5p3psfcoxiq-8000.proxy.runpod.net/sam_image', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ image_base64: base64Image }),
                    })
                    .then(response => response.json())
                    .then(data => {
                        console.log(data);
                        window.location.href = 'test.html'; // 或者隐藏模态框
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        modal.innerText = '上传失败'; // 更新模态框文本
                        setTimeout(() => modal.style.display = 'none', 3000); // 3秒后隐藏模态框
                    });
                };
                reader.readAsDataURL(file); // 将文件读取为Base64
            } else {
                modal.innerText = '请选择一个文件！'; // 更新模态框文本
                modal.style.display = 'flex';
                setTimeout(() => modal.style.display = 'none', 3000); // 3秒后隐藏模态框
            }
        });
    </script>
</body>
</html>
